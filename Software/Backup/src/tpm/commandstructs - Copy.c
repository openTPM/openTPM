#include <stdio.h>
#include <string.h>
#include <asf.h>

#include "commandStructs.h"
#include "commandFuncs.h"
#include "utils.h"

// static uint8_t _getSetMem[] = "getSetMem";
// static uint8_t __getSetMem[] =
// {
// 	0x00, 0xC1,
// 	0x00, 0x00, 0x00, 0x0F,
// 	0x20, 0x00, 0x00, 0x09,
// 	0x80, 0x01,
// 	0x00, 0x4F,
// 	0x03,
// };
// 
// static uint8_t _getCap_versVal[] = "getCap_versVal";
// static uint8_t __getCap_versVal[] =
// {
// 	0x00, 0xC1,
// 	0x00, 0x00, 0x00, 0x16,
// 	0x00, 0x00, 0x00, 0x65,
// 	0x00, 0x00, 0x00, 0x1A,
// 	0x00, 0x00, 0x00, 0x04,
// 	0x00, 0x00, 0x00, 0x00,
// };
// 
// static uint8_t _getCap_version[]  = "getCap_version";
// static uint8_t __getCap_version[] =
// {
// 	0x00, 0xc1,
// 	0x00, 0x00, 0x00, 0x12,
// 	0x00, 0x00, 0x00, 0x65,
// 	0x00, 0x00, 0x00, 0x06,
// 	0x00, 0x00, 0x00, 0x00,
// };
// 
static uint8_t _startupClear[] = "startupClear";
static uint8_t __startupClear[]  =
{
	0x00, 0xC1,
	0x00, 0x00, 0x00, 0x0C,
	0x00, 0x00, 0x00, 0x99,
	0x00, 0x01,
};
// 
// static uint8_t _startupState[]  = "startupState";
// static uint8_t __startupState[]  =
// {
// 	0x00, 0xC1,
// 	0x00, 0x00, 0x00, 0x0C,
// 	0x00, 0x00, 0x00, 0x99,
// 	0x00, 0x02,
// };
// 
// static uint8_t _contSelfTest[] = "contSelfTest";
// static uint8_t __contSelfTest[] =
// {
// 	0x00, 0xC1,
// 	0x00, 0x00, 0x00, 0x0A,
// 	0x00, 0x00, 0x00, 0x53
// };
// 
// static uint8_t _forceClear[]  = "forceClear";
// static uint8_t __forceClear[]  =
// {
// 	0x00, 0xC1,
// 	0x00, 0x00, 0x00, 0x0A,
// 	0x00, 0x00, 0x00, 0x5D
// };
// 
// static uint8_t _OIAP[]  = "OIAP";
// static uint8_t __OIAP[]  =
// {
// 	0x00, 0xC1,
// 	0x00, 0x00, 0x00, 0x0A,
// 	0x00, 0x00, 0x00, 0x0A
// };
// 
// static uint8_t _OSAP[]  = "OSAP";
// static uint8_t __OSAP[]  =
// {
// 	0x00, 0xc1,
// 	0x00, 0x00, 0x00, 0x24,
// 	0x00, 0x00, 0x00, 0x0b,
// 	0x00, 0x01,
// 	0x40, 0x00, 0x00, 0x00,
// 	0xb9, 0x73, 0x05, 0xfa, 0xdb, 0xe3, 0x4d, 0xc5, 0x46, 0x65,
// 	0x10, 0x00, 0x0a, 0x55, 0x04, 0x2e, 0x3f, 0xea, 0xbf, 0x27,
//};
// 
// static uint8_t _OSAP_ET_KH_SRK[]  = "OSAP_ET_KH_SRK";
// static uint8_t __OSAP_ET_KH_SRK[]  =
// {
// 	0x00, 0xc1,
// 	0x00, 0x00, 0x00, 0x24,
// 	0x00, 0x00, 0x00, 0x0b,
// 	0x00, 0x01,
// 	0x40, 0x00, 0x00, 0x00,
// 	0xb9, 0x73, 0x05, 0xfa, 0xdb, 0xe3, 0x4d, 0xc5, 0x46, 0x65,
// 	0x10, 0x00, 0x0a, 0x55, 0x04, 0x2e, 0x3f, 0xea, 0xbf, 0x27,
//};
// 
// static uint8_t _OSAP_ET_Key_SRK[]  = "OSAP_ET_Key_SRK";
// static uint8_t __OSAP_ET_Key_SRK[]  =
// {
// 	0x00, 0xC1,
// 	0x00, 0x00, 0x00, 0x24,
// 	0x00, 0x00, 0x00, 0x0B,
// 	0x00, 0x05,
// 	0x40, 0x00, 0x00, 0x00,
// 	0x1F, 0x89, 0xFF, 0x11, 0xF6, 0xAE, 0xBE, 0x5D, 0x9B, 0xF5,
// 	0xF3, 0xA9, 0x5D, 0x9E, 0xCB, 0x0E, 0x79, 0xD0, 0xE9, 0xBA,
//};
// 
// static uint8_t _physPres_present[]  = "physPres_present";
// static uint8_t __physPres_present[]  =
// {
// 	0x00, 0xC1,
// 	0x00, 0x00, 0x00, 0x0C,
// 	0x40, 0x00, 0x00, 0x0A,
// 	0x00, 0x08,
// };
// 
// static uint8_t _physEnable[]  = "physEnable";
// static uint8_t __physEnable[]  =
// {
// 	0x00, 0xC1,
// 	0x00, 0x00, 0x00, 0x0A,
// 	0x00, 0x00, 0x00, 0x6F,
// };
// 
// static uint8_t _physDisable[]  = "physDisable";
// static uint8_t __physDisable[]  =
// {
// 	0x00, 0xC1,
// 	0x00, 0x00, 0x00, 0x0A,
// 	0x00, 0x00, 0x00, 0x70,
// };
// 
// static uint8_t _physSetDeact_false[]  = "physSetDeact_false";
// static uint8_t __physSetDeact_false[]  =
// {
// 	0x00, 0xC1,
// 	0x00, 0x00, 0x00, 0x0B,
// 	0x00, 0x00, 0x00, 0x72,
// 	0x00,
// };
// 
// static uint8_t _physSetDeact_true[]  = "physSetDeact_true";
// static uint8_t __physSetDeact_true[]  =
// {
// 	0x00, 0xC1,
// 	0x00, 0x00, 0x00, 0x0B,
// 	0x00, 0x00, 0x00, 0x72,
// 	0x01,
// };
// 
// static uint8_t _readEK[]  = "readEK";
// static uint8_t __readEK[]  =
// {
// 	0x00, 0xC1,
// 	0x00, 0x00, 0x00, 0x1E,
// 	0x00, 0x00, 0x00, 0x7C,
// 	0xB9, 0x73, 0x05, 0xFA, 0xDB, 0xE3, 0x4D, 0xC5, 0x46, 0x65,
// 	0x10, 0x00, 0x0A, 0x55, 0x04, 0x2E, 0x3F, 0xEA, 0xBF, 0x27,
// };
// 
// 
// static uint8_t _getPubKey[]  = "getPubKey";
// static uint8_t __getPubKey[]  =
// {
// 	0x00, 0xC2,
// 	0x00, 0x00, 0x00, 0x3B,
// 	0x00, 0x00, 0x00, 0x21,
// 	0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00,
// 	0xBC, 0xC0, 0x48, 0x8D, 0x86, 0x39, 0xCF, 0xF3, 0x2B, 0xFC,
// 	0x5F, 0x2F, 0x7C, 0xAF, 0x44, 0x97, 0x75, 0xA9, 0x28, 0x23,
// 	0x00,
// 	0x9A, 0x6A, 0x5C, 0xDE, 0x44, 0xF4, 0xB9, 0xBB, 0x8B, 0x0D,
// 	0xE9, 0x50, 0x78, 0x0D, 0x87, 0x91, 0x8C, 0x46, 0x50, 0x3E,
// };
// 
// 
// static uint8_t _createEKPair[]  = "createEKPair";
// static uint8_t __createEKPair[]  =
// {
// 	0x00, 0xC1,
// 	0x00, 0x00, 0x00, 0x36,
// 	0x00, 0x00, 0x00, 0x78,
// 	0xEC, 0x0C, 0xC4, 0xD3, 0x26, 0xED, 0x5F, 0xA5, 0xF5, 0xB1,
// 	0x78, 0x1B, 0x37, 0x5D, 0x24, 0xA3, 0x36, 0x36, 0xE5, 0x42,
// 	0x00, 0x00, 0x00, 0x01,
// 	0x00, 0x03,
// 	0x00, 0x01,
// 	0x00, 0x00, 0x00, 0x0C,
// 	0x00, 0x00, 0x08, 0x00,
// 	0x00, 0x00, 0x00, 0x02,
// 	0x00, 0x00, 0x00, 0x00,
// };
// 
// static uint8_t _createWrapKey[]  = "createWrapKey";
// static uint8_t __createWrapKey[]  =
// {
// 	0x00, 0xc2,
// 	0x00, 0x00, 0x00, 0x92,
// 	0x00, 0x00, 0x00, 0x1f,
// 	0x40, 0x00, 0x00, 0x00,
// 	0x76, 0x1c, 0x37, 0xe1, 0x32, 0x86, 0xb9, 0xd1, 0x3e, 0x27,
// 	0x84, 0x08, 0x37, 0xae, 0xc8, 0xc1, 0xf3, 0x11, 0x9c, 0xa7,
// 	0xd2, 0xd5, 0x2a, 0x24, 0xa5, 0x06, 0x78, 0xcb, 0xbd, 0x57,
// 	0x4d, 0x0d, 0x16, 0xe6, 0xa6, 0xa8, 0x10, 0x7d, 0x70, 0xf1,
// 	0x00, 0x28,
// 	0x00, 0x00,
// 	0x00, 0x10,
// 	0x00, 0x00, 0x00, 0x00,
// 	0x01,
// 	0x00, 0x00, 0x00, 0x01,
// 	0x00, 0x01,
// 	0x00, 0x02,
// 	0x00, 0x00, 0x00, 0x0c,
// 	0x00, 0x00, 0x08, 0x00,
// 	0x00, 0x00, 0x00, 0x02,
// 	0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00,
// 	0xb9, 0x73, 0x05, 0xfa, 0xdb, 0xe3, 0x4d, 0xc5, 0x46, 0x65,
// 	0x10, 0x00, 0x0a, 0x55, 0x04, 0x2e, 0x3f, 0xea, 0xbf, 0x27,
// 	0x00,
// 	0x51, 0xC2, 0xD4, 0xA9, 0xB4, 0x7A, 0x8B, 0x1D, 0xBA, 0xBF,
// 	0x15, 0xD6, 0x20, 0x2E, 0x7C, 0x09, 0x2A, 0x57, 0x5A, 0xDF,
// };
// 
// static uint8_t _createWrapKey_PCR[]  = "createWrapKey_PCR";
// static uint8_t __createWrapKey_PCR[]  =
// {
// 	0x00, 0xc2,
// 	0x00, 0x00, 0x00, 0xC8,
// 	0x00, 0x00, 0x00, 0x1f,
// 	0x40, 0x00, 0x00, 0x00,
// 	0x76, 0x1c, 0x37, 0xe1, 0x32, 0x86, 0xb9, 0xd1, 0x3e, 0x27,
// 	0x84, 0x08, 0x37, 0xae, 0xc8, 0xc1, 0xf3, 0x11, 0x9c, 0xa7,
// 	0xd2, 0xd5, 0x2a, 0x24, 0xa5, 0x06, 0x78, 0xcb, 0xbd, 0x57,
// 	0x4d, 0x0d, 0x16, 0xe6, 0xa6, 0xa8, 0x10, 0x7d, 0x70, 0xf1,
// 	0x00, 0x28,
// 	0x00, 0x00,
// 	0x00, 0x11,
// 	0x00, 0x00, 0x00, 0x00,
// 	0x01,
// 	0x00, 0x00, 0x00, 0x01,
// 	0x00, 0x03,
// 	0x00, 0x01,
// 	0x00, 0x00, 0x00, 0x0C,
// 	0x00, 0x00, 0x08, 0x00,
// 	0x00, 0x00, 0x00, 0x02,
// 	0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x36,
// 	0x00, 0x06,
// 	0x01,
// 	0x1F,
// 	0x00, 0x03,
// 	0x01, 0x00, 0x00,
// 	0x00, 0x03,
// 	0x01, 0x00, 0x00,
// 	0xCD, 0x45, 0x31, 0x66, 0xFB, 0x4D, 0xC0, 0x20, 0x3F, 0x00,
// 	0x35, 0x42, 0xF9, 0x44, 0xB9, 0xD4, 0x69, 0xDD, 0xB1, 0xF9,
// 	0xCD, 0x45, 0x31, 0x66, 0xFB, 0x4D, 0xC0, 0x20, 0x3F, 0x00,
// 	0x35, 0x42, 0xF9, 0x44, 0xB9, 0xD4, 0x69, 0xDD, 0xB1, 0xF9,
// 	0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00,
// 	0xb9, 0x73, 0x05, 0xfa, 0xdb, 0xe3, 0x4d, 0xc5, 0x46, 0x65,
// 	0x10, 0x00, 0x0a, 0x55, 0x04, 0x2e, 0x3f, 0xea, 0xbf, 0x27,
// 	0x00,
// 	0x51, 0xC2, 0xD4, 0xA9, 0xB4, 0x7A, 0x8B, 0x1D, 0xBA, 0xBF,
// 	0x15, 0xD6, 0x20, 0x2E, 0x7C, 0x09, 0x2A, 0x57, 0x5A, 0xDF,
// };
// static uint8_t _loadKey[]  = "loadKey";
// static uint8_t __loadKey[]  =
// {
// 	0x00, 0xC2,
// 	0x00, 0x00, 0x02, 0x6A,
// 	0x00, 0x00, 0x00, 0x41,
// 	0x40, 0x00, 0x00, 0x00,
// };
// 
// static uint8_t _takeOwnership[]  = "takeOwnership";
// static uint8_t __takeOwnership[]  =
// {
// 	0x00, 0xC2,
// 	0x00, 0x00, 0x02, 0x70,
// 	0x00, 0x00, 0x00, 0x0D,
// 	0x00, 0x05,
// 	0x00, 0x00, 0x01, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x01, 0x00,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
// 	//	0x00, 0x28,
// 	0x01, 0x01,
// 	0x00, 0x00,
// 	0x00, 0x11,
// 	0x00, 0x00, 0x00, 0x00,
// 	0x01,
// 	0x00, 0x00, 0x00, 0x01,
// 	0x00, 0x03,
// 	0x00, 0x01,
// 	0x00, 0x00, 0x00, 0x0C,
// 	0x00, 0x00, 0x08, 0x00,
// 	0x00, 0x00, 0x00, 0x02,
// 	0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00,
// 	0xAA, 0xAA, 0xAA, 0xAA,
// 	0xB9, 0x73, 0x05, 0xFA, 0xDB, 0xE3, 0x4D, 0xC5, 0x46, 0x65,
// 	0x10, 0x00, 0x0A, 0x55, 0x04, 0x2E, 0x3F, 0xEA, 0xBF, 0x27,
// 	0x00,
// 	0xCC, 0xCC, 0xCC, 0xCC, 0xCC, 0xCC, 0xCC, 0xCC, 0xCC, 0xCC,
// 	0xCC, 0xCC, 0xCC, 0xCC, 0xCC, 0xCC, 0xCC, 0xCC, 0xCC, 0xCC,
// };
// 
// static uint8_t _bindV20[]  = "bindV20";
// static uint8_t _bindV20_g[]  = "bindV20_g";	// generic version for demo
// static uint8_t __bindV20[]  =
// {
// 	0x00, 0xC1,
// 	0x00, 0x00, 0x01, 0x26,
// 	0x20, 0x00, 0x00, 0x06,
// 	0x00, 0x00, 0x01, 0x00,
// 	0xAB, 0x56, 0x7C, 0x0E, 0x60, 0x8C, 0x5C, 0x18,
// 	0x9E, 0x90, 0x2C, 0x37, 0x32, 0xCF, 0xE3, 0xFE,
// 	0x4F, 0xA7, 0xB5, 0x0C, 0x78, 0xA1, 0x5D, 0xA7,
// 	0x39, 0xEB, 0xC0, 0x06, 0x87, 0x05, 0xDB, 0x1F,
// 	0xE4, 0xAB, 0x2A, 0x9A, 0x68, 0xE3, 0x5B, 0xB6,
// 	0xFB, 0x27, 0x69, 0x5A, 0x4B, 0xE2, 0x90, 0x65,
// 	0x04, 0xB2, 0x78, 0xCF, 0x44, 0x02, 0x7C, 0x16,
// 	0x4C, 0xFB, 0xF5, 0xF0, 0xF6, 0x25, 0x7D, 0x31,
// 	0xF1, 0x2E, 0xD8, 0x67, 0x93, 0x5A, 0x48, 0xB2,
// 	0xC1, 0x4C, 0x16, 0xFD, 0x97, 0xE5, 0x86, 0x65,
// 	0x4A, 0x2E, 0x07, 0x4B, 0x14, 0x78, 0xF7, 0x66,
// 	0x83, 0x66, 0x05, 0xB0, 0xEA, 0xEC, 0x1E, 0x16,
// 	0xCF, 0xF9, 0xF9, 0xC5, 0x5C, 0xBC, 0x7B, 0x42,
// 	0x24, 0xA1, 0xA7, 0x1B, 0x55, 0xD7, 0x4B, 0xB1,
// 	0x62, 0x7F, 0x90, 0x88, 0xEE, 0xFB, 0xFB, 0x26,
// 	0xB1, 0x4F, 0x56, 0x97, 0x8C, 0xD0, 0x12, 0x05,
// 	0xA6, 0xEF, 0x09, 0xC9, 0x08, 0x10, 0xF2, 0x1B,
// 	0x65, 0x9C, 0xF2, 0x05, 0x7B, 0xCC, 0x4E, 0x6A,
// 	0x65, 0x0C, 0x1C, 0xE1, 0xB5, 0x3E, 0x86, 0x7D,
// 	0xF8, 0x0B, 0x8B, 0x6F, 0xE3, 0x72, 0x2B, 0xCB,
// 	0xC9, 0x3D, 0xF8, 0x61, 0xF4, 0x83, 0x74, 0xB1,
// 	0x38, 0xA6, 0xCE, 0xDE, 0x18, 0x7F, 0x8D, 0xC4,
// 	0x8F, 0xA1, 0x8E, 0xA6, 0xAC, 0x71, 0xA4, 0x89,
// 	0x60, 0xD3, 0x3E, 0x5F, 0x3D, 0x18, 0x5C, 0x32,
// 	0x6C, 0x96, 0x1D, 0x84, 0x8B, 0x50, 0xC3, 0x5B,
// 	0x68, 0x5C, 0x16, 0x2D, 0x9C, 0xBB, 0xF1, 0x79,
// 	0x60, 0x6E, 0xC9, 0x25, 0xAA, 0xEC, 0x26, 0x9E,
// 	0x9E, 0xD4, 0xD6, 0x89, 0xF3, 0xFF, 0x23, 0xAA,
// 	0x75, 0x46, 0x3B, 0x4A, 0xEA, 0x1D, 0xE5, 0x03,
// 	0xB9, 0xAC, 0x6D, 0xF8, 0x2D, 0x88, 0xFF, 0x84,
// 	0x12, 0xB8, 0x47, 0xCF, 0x3A, 0x32, 0xC9, 0x66,
// 	0xC6, 0xE3, 0x2C, 0x1F, 0x7D, 0x30, 0xD8, 0x99,
// 	0x00, 0x00, 0x00, 0x14,
// 	0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09,
// 	0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13,
// };
// 
// static uint8_t _seal[]  = "seal";
// static uint8_t __seal[]  =
// {
// 	0x00, 0xC2,
// 	0x00, 0x00, 0x00, 0x6B,
// 	0x00, 0x00, 0x00, 0x17,
// 	0x40, 0x00, 0x00, 0x00,
// 	0x83, 0x91, 0xE5, 0xD4, 0x6F, 0xC4, 0x36, 0x7C, 0xDB, 0xF9,
// 	0x01, 0xBB, 0x0D, 0xD8, 0xA5, 0x2A, 0xD0, 0xBC, 0xD9, 0xE7,
// 	0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x14,
// 	0x21, 0x28, 0x88, 0x7F, 0x0F, 0xF1, 0x12, 0x0F, 0x91, 0x7B,
// 	0x2E, 0x59, 0x41, 0x47, 0xF4, 0x63, 0x7E, 0x67, 0x37, 0xAD,
// 	0x00, 0x00, 0x00, 0x00,
// 	0x00, 0xB1, 0x26, 0x29, 0xC0, 0x53, 0x66, 0x07, 0xB5, 0x39,
// 	0x7D, 0x01, 0x93, 0xAE, 0xAE, 0x23, 0x02, 0x0E, 0x76, 0x1E,
// 	0x00,
// 	0x73, 0xD1, 0xF6, 0xE6, 0x63, 0xC1, 0x98, 0x12, 0x17, 0x65,
// 	0x10, 0x71, 0x8A, 0xF3, 0x95, 0xF5, 0x0A, 0x08, 0x8E, 0x8B,
//};
// 
// static uint8_t _unSeal[]  = "unSeal";
// static uint8_t __unSeal[]  =
// {
// 	0x00, 0xC3,
// 	0x00, 0x00, 0x01, 0x74,
// 	0x00, 0x00, 0x00, 0x18,
// 	0x40, 0x00, 0x00, 0x00,
// 	0x01, 0x01, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x01, 0x00,
// 	0xA6, 0x1F, 0xE8, 0x6E, 0x02, 0x97, 0xFA, 0x0E,
// 	0x61, 0x83, 0xD8, 0x2C, 0x85, 0xAE, 0xAC, 0xF9,
// 	0xD9, 0x92, 0x29, 0x82, 0x79, 0x8A, 0x88, 0xD8,
// 	0xCB, 0xDF, 0x85, 0xF7, 0x5B, 0x67, 0x7C, 0x42,
// 	0xD5, 0x75, 0x55, 0x7D, 0xA9, 0x23, 0x29, 0xB8,
// 	0x86, 0x73, 0x12, 0xD8, 0x4B, 0x1E, 0xC8, 0x70,
// 	0x2C, 0x37, 0xF2, 0x86, 0x76, 0xCD, 0xA0, 0x74,
// 	0xF8, 0xD1, 0xBC, 0x9D, 0x4E, 0x9F, 0xC0, 0xE2,
// 	0x92, 0xE2, 0x29, 0x80, 0x40, 0x8F, 0x1F, 0xE1,
// 	0x39, 0x5E, 0x61, 0x83, 0xE9, 0x4F, 0xA2, 0xF5,
// 	0xB6, 0xD2, 0x3C, 0x54, 0x56, 0x27, 0x6C, 0xD7,
// 	0x87, 0xE5, 0xF8, 0xC4, 0x1A, 0xE0, 0xC1, 0xEB,
// 	0xF6, 0xD8, 0x02, 0xBD, 0xFB, 0xEA, 0xF3, 0x02,
// 	0x73, 0xFD, 0xEB, 0xB0, 0x00, 0xD7, 0xD4, 0xCA,
// 	0xA7, 0xD7, 0xB8, 0x1E, 0x3B, 0xD0, 0x8E, 0x5C,
// 	0x4C, 0xB2, 0x49, 0x60, 0x21, 0x2B, 0x72, 0xF5,
// 	0xB0, 0x30, 0x9B, 0xA2, 0xE5, 0xE5, 0x56, 0x43,
// 	0x49, 0xA5, 0xDB, 0x7B, 0x99, 0xFD, 0x8D, 0x80,
// 	0xDA, 0xB8, 0x05, 0x36, 0x82, 0x57, 0xD4, 0xC8,
// 	0x6E, 0xA7, 0xF4, 0xE9, 0xDE, 0x43, 0xE3, 0xC6,
// 	0xBD, 0x1F, 0x8F, 0x6A, 0xA8, 0x97, 0x95, 0x1A,
// 	0xB2, 0xD5, 0xD0, 0x8E, 0x31, 0xBE, 0xB9, 0x49,
// 	0x87, 0x26, 0xA5, 0xBF, 0x0F, 0xB4, 0x90, 0x51,
// 	0xC7, 0xF6, 0xE4, 0x69, 0xE0, 0x8C, 0xDB, 0x4F,
// 	0xDB, 0xAD, 0xF6, 0x14, 0x12, 0x45, 0x15, 0xE9,
// 	0x33, 0xE8, 0xB5, 0x1A, 0x41, 0x9C, 0x1C, 0x80,
// 	0xC2, 0xA7, 0x46, 0x0D, 0xD9, 0x5E, 0x81, 0xEE,
// 	0x6F, 0x39, 0x65, 0x77, 0x41, 0x84, 0x3C, 0x13,
// 	0x11, 0x24, 0x09, 0x64, 0x91, 0xED, 0xE6, 0x91,
// 	0x3F, 0xDF, 0x3A, 0xBD, 0x72, 0x25, 0x57, 0x55,
// 	0xFC, 0xFB, 0x59, 0x39, 0x76, 0xD8, 0x00, 0x9F,
// 	0x13, 0x39, 0x29, 0x87, 0x1D, 0xA4, 0x4F, 0x3D,
// 	0x00, 0x00, 0x00, 0x00,
// 	0x52, 0x3A, 0xE6, 0xA1, 0x14, 0x54, 0xA8, 0x2A, 0xCA, 0x63,
// 	0xE4, 0x5A, 0x19, 0x77, 0x4D, 0xBD, 0x8A, 0x25, 0xFD, 0xFE,
// 	0x00,
// 	0xC3, 0x4A, 0x91, 0xD9, 0x41, 0x5F, 0xA8, 0xED, 0x5A, 0x6B,
// 	0xBE, 0xC6, 0x8B, 0x47, 0x2E, 0x05, 0x8C, 0xB1, 0x7C, 0xD5,
// 	0x00, 0x00, 0x00, 0x01,
// 	0x1F, 0x0B, 0x49, 0xE3, 0x13, 0x82, 0xCD, 0xDA, 0x81, 0xB6,
// 	0x08, 0xEC, 0x46, 0xEF, 0x84, 0x94, 0xF8, 0x54, 0xD5, 0xD8,
// 	0x00,
// 	0xF3, 0x81, 0x39, 0x61, 0x6C, 0x03, 0x80, 0x53, 0xDF, 0xBA,
// 	0xC4, 0x88, 0x8F, 0x97, 0xD6, 0x42, 0x42, 0x87, 0x0C, 0xBF,
//};
// 
// static uint8_t _sign[]  = "sign";
// static uint8_t __sign[]  =
// {
// 	0x00, 0xC2,
// 	0x00, 0x00, 0x00, 0x53,
// 	0x00, 0x00, 0x00, 0x3C,
// 	0x8C, 0x9A, 0x2F, 0xEB,
// 	0x00, 0x00, 0x00, 0x14,
// 	0xC7, 0xE3, 0xE1, 0x87, 0xA5, 0x7F, 0xC8, 0xCF, 0x22, 0x0D,
// 	0x0B, 0x90, 0x10, 0x67, 0x95, 0xF8, 0xD9, 0x12, 0x25, 0xA6,
// 	0x3B, 0xFD, 0xEE, 0xEF,
// 	0x69, 0x2E, 0x03, 0x5E, 0x4F, 0x7D, 0xCA, 0x0D, 0x24, 0x1A,
// 	0xAB, 0xB5, 0xBB, 0x49, 0xEE, 0x55, 0x0A, 0xD9, 0x54, 0x76,
// 	0x00,
// 	0x9B, 0x94, 0x47, 0x37, 0x89, 0x90, 0x55, 0x61, 0x09, 0x6C,
// 	0xC1, 0x76, 0x93, 0x70, 0x1F, 0x23, 0x79, 0xB7, 0x13, 0xAA,
// };
// 
// static uint8_t _verifySign[]  = "verifySign";
// static uint8_t __verifySign[]  =
// {
// 	0x00, 0xC1,
// 	0x00, 0x00, 0x02, 0x42,
// 	0x20, 0x00, 0x00, 0x05,
// 	0x00, 0x00, 0x00, 0x14,
// 	0xC7, 0xE3, 0xE1, 0x87, 0xA5, 0x7F, 0xC8, 0xCF, 0x22, 0x0D,
// 	0x0B, 0x90, 0x10, 0x67, 0x95, 0xF8, 0xD9, 0x12, 0x25, 0xA6,
// 	0x00, 0x00, 0x01, 0x00,
// 	//	0x75, 0x69, 0x66, 0x38, 0x53, 0xEE, 0xAC, 0x50,
// 	//	0xAA, 0x76, 0xA7, 0x4E, 0x4F, 0xB2, 0x74, 0xCF,
// 	//	0x41, 0x4C, 0xCB, 0x90, 0x5E, 0x5A, 0x52, 0xA2,
// 	//	0xCC, 0xE6, 0x2D, 0x9D, 0x82, 0x59, 0xBE, 0x30,
// 	//	0x4C, 0xD7, 0x2D, 0xCD, 0xEE, 0x12, 0x79, 0xBB,
// 	//	0x0E, 0xF5, 0x9E, 0x98, 0xC2, 0x31, 0x13, 0x98,
// 	//	0xED, 0x3C, 0x6C, 0xE8, 0x0E, 0xF2, 0x83, 0xD7,
// 	//	0x2E, 0x2D, 0x99, 0xAC, 0x96, 0xD4, 0xB8, 0x40,
// 	//	0x43, 0x6F, 0xB1, 0xE5, 0x0F, 0xB3, 0x4A, 0xE9,
// 	//	0xCB, 0x6B, 0x2C, 0x24, 0x26, 0xF0, 0x0D, 0xB1,
// 	//	0x90, 0x99, 0x0A, 0x57, 0x01, 0xF7, 0x5D, 0x44,
// 	//	0x47, 0x15, 0x4B, 0xB1, 0x42, 0x41, 0xB0, 0xCB,
// 	//	0xB4, 0x54, 0x86, 0x74, 0x7F, 0xAC, 0xD3, 0xB6,
// 	//	0xB1, 0x31, 0xE3, 0xB2, 0xBF, 0x5B, 0x32, 0xAC,
// 	//	0x85, 0xBB, 0xEF, 0x1C, 0xBB, 0x50, 0xA2, 0xAC,
// 	//	0x26, 0x52, 0xC0, 0x3A, 0x31, 0x6F, 0x29, 0xC5,
// 	//	0x15, 0x0D, 0xB4, 0x79, 0x47, 0x6A, 0x7C, 0x35,
// 	//	0x89, 0x18, 0xE0, 0x49, 0x77, 0x8C, 0x25, 0x9B,
// 	//	0x6E, 0x57, 0x47, 0x85, 0xFE, 0x0D, 0x4F, 0x05,
// 	//	0x6D, 0x7D, 0xC4, 0x26, 0xE8, 0xF0, 0xFA, 0xC9,
// 	//	0x30, 0x04, 0x83, 0x84, 0x23, 0x86, 0xA9, 0x3C,
// 	//	0x01, 0xFC, 0xBE, 0x80, 0x3A, 0x6C, 0x67, 0xCE,
// 	//	0x34, 0x76, 0x24, 0xA1, 0xB4, 0xC3, 0x03, 0x56,
// 	//	0x42, 0xDF, 0x84, 0x2D, 0x2D, 0xAF, 0xE2, 0x9D,
// 	//	0x81, 0xCE, 0xEB, 0x0C, 0xA6, 0x65, 0xD6, 0xCC,
// 	//	0x9E, 0x50, 0x84, 0xAF, 0xD9, 0xF4, 0x1B, 0x9A,
// 	//	0x0D, 0x42, 0x89, 0x7C, 0x01, 0x01, 0xCA, 0x9C,
// 	//	0x38, 0x99, 0x98, 0x9B, 0xF1, 0x17, 0xA9, 0x16,
// 	//	0x56, 0x21, 0xA9, 0x07, 0x5A, 0xDB, 0xD8, 0xD5,
// 	//	0x9C, 0x50, 0xFF, 0xE1, 0xFD, 0xCA, 0x05, 0x1F,
// 	//	0xAB, 0xB3, 0xDD, 0xCC, 0x8F, 0x5C, 0x1D, 0xAB,
// 	//	0x11, 0x21, 0xEA, 0x33, 0x6D, 0xB3, 0x25, 0xB6,
// 	//	0x00, 0x00, 0x00, 0x01,
// 	//	0x00, 0x01,
// 	//	0x00, 0x02,
// 	//	0x00, 0x00, 0x00, 0x0C,
// 	//	0x00, 0x00, 0x08, 0x00,
// 	//	0x00, 0x00, 0x00, 0x02,
// 	//	0x00, 0x00, 0x00, 0x00,
// 	//	0x00, 0x00, 0x01, 0x00,
// 	//	0xB4, 0xDE, 0x41, 0x9B, 0xBE, 0xB8, 0xE5, 0xF3,
// 	//	0xFC, 0xC1, 0x2B, 0x4F, 0x37, 0x12, 0x90, 0x6D,
// 	//	0x23, 0xD2, 0x5D, 0xE8, 0x35, 0x8B, 0x24, 0xE4,
// 	//	0x73, 0x73, 0x5D, 0x6B, 0xCB, 0x80, 0x35, 0x12,
// 	//	0x29, 0xDE, 0x0A, 0x6B, 0xBC, 0x19, 0x47, 0x13,
// 	//	0xA0, 0x8F, 0x7C, 0xC2, 0x8C, 0xE5, 0x53, 0x0D,
// 	//	0xC9, 0xD3, 0x3D, 0x57, 0xDA, 0x92, 0xE7, 0x8B,
// 	//	0xA2, 0xBA, 0x7F, 0x63, 0x19, 0xBD, 0xCF, 0xB1,
// 	//	0x12, 0xBE, 0x32, 0x83, 0x9C, 0x1D, 0xE3, 0x82,
// 	//	0x3A, 0xE4, 0x22, 0x25, 0x5B, 0xF1, 0x90, 0xAE,
// 	//	0x5D, 0x44, 0x20, 0xC2, 0x7D, 0x83, 0xAA, 0x18,
// 	//	0x3A, 0x8B, 0x38, 0x8B, 0x08, 0x0D, 0xFF, 0x6D,
// 	//	0xF0, 0x9D, 0x4A, 0xFF, 0xB2, 0x7A, 0xC2, 0x26,
// 	//	0x19, 0xF5, 0x62, 0xAA, 0xFE, 0x0A, 0x2A, 0xBE,
// 	//	0x6E, 0x77, 0x25, 0xDE, 0xB4, 0x1E, 0x40, 0x8B,
// 	//	0xF7, 0x23, 0xBD, 0x6B, 0xA2, 0x72, 0x53, 0x8E,
// 	//	0xE3, 0xF5, 0xB9, 0x53, 0x91, 0x1B, 0x7E, 0xE2,
// 	//	0xD5, 0xCA, 0x0E, 0xC2, 0x4E, 0x77, 0x65, 0x38,
// 	//	0x96, 0xB5, 0x4D, 0xC4, 0xA1, 0x23, 0x93, 0x8D,
// 	//	0x39, 0x91, 0x58, 0x26, 0x77, 0xF6, 0xD4, 0x79,
// 	//	0xFA, 0x74, 0xFA, 0x1B, 0x53, 0xE8, 0xBB, 0x1C,
// 	//	0x2A, 0x47, 0xD7, 0xC5, 0x42, 0x38, 0xA0, 0x11,
// 	//	0xF6, 0x6B, 0x21, 0x7E, 0x3D, 0x48, 0x5C, 0xF7,
// 	//	0x42, 0x6B, 0x4E, 0x43, 0xF7, 0x9E, 0x15, 0x8B,
// 	//	0x39, 0xFF, 0x4C, 0xF1, 0x91, 0xCD, 0x46, 0x27,
// 	//	0x90, 0x22, 0x68, 0xFB, 0x18, 0xC7, 0x60, 0x72,
// 	//	0x3A, 0x67, 0xCF, 0x97, 0x00, 0xDB, 0x7A, 0xD8,
// 	//	0x01, 0xD8, 0x77, 0xEE, 0xA4, 0x5C, 0x34, 0xEE,
// 	//	0x08, 0x9B, 0xB9, 0xAA, 0x50, 0xA2, 0x22, 0x5A,
// 	//	0xAA, 0xA5, 0x7E, 0x01, 0x92, 0x37, 0xF0, 0xC2,
// 	//	0x80, 0xF5, 0x4B, 0x85, 0x8F, 0xCC, 0x8A, 0xBE,
// 	//	0x63, 0x01, 0x05, 0x92, 0x06, 0xD9, 0xBC, 0x79,
// };
// 
// static uint8_t _flushKey[]  = "flushKey";
// static uint8_t __flushKey[]  =
// {
// 	0x00, 0xC1,
// 	0x00, 0x00, 0x00, 0x12,
// 	0x00, 0x00, 0x00, 0xBA,
// 	0x00, 0x00, 0x00, 0x00,
// 	0x00, 0x00, 0x00, 0x01,
// };
// 
// static uint8_t _terminateHandle0[]  = "terminateHandle0";
// static uint8_t __terminateHandle0[]  =
// {
// 	0x00, 0xC1,
// 	0x00, 0x00, 0x00, 0x0E,
// 	0x00, 0x00, 0x00, 0x96,
// 	0x00, 0x00, 0x00, 0x00,
// };
// 
// static uint8_t _terminateHandle1[]  = "terminateHandle1";
// static uint8_t __terminateHandle1[]  =
// {
// 	0x00, 0xC1,
// 	0x00, 0x00, 0x00, 0x0E,
// 	0x00, 0x00, 0x00, 0x96,
// 	0x00, 0x00, 0x00, 0x01,
// };
// 
// static uint8_t _reset[]  = "reset";
// static uint8_t __reset[]  =
// {
// 	0x00, 0xC1,
// 	0x00, 0x00, 0x00, 0x0A,
// 	0x00, 0x00, 0x00, 0x5A,
// };
// 
// 
// // compliance EK (keyA) -- first 16 bytes
// uint8_t compPubEK[]  =
// {
// 	0xAB, 0x56, 0x7C, 0x0E, 0x60, 0x8C, 0x5C, 0x18,
// 	0x9E, 0x90, 0x2C, 0x37, 0x32, 0xCF,	0xE3, 0xFE,
// };
// 
// // compliance owner auth (SecretA)
// uint8_t ownAuth[]  =
// {
// 	0xa2, 0x18, 0x08, 0xb2, 0x18, 0x38, 0xa2, 0x06, 0x50, 0x16,
// 	0xe6, 0xe2, 0x00, 0x5c, 0xcd, 0x5c, 0x80, 0x3f, 0x25, 0xb9,
// };
// 
// // compliance SRK auth (SecretB)
// uint8_t SRKAuth[]  =
// {
// 	0x36, 0xF7, 0x56, 0x60, 0xE9, 0x73, 0xF8, 0x8A, 0xC0, 0x80,
// 	0xCD, 0x95, 0x65, 0xC0, 0x3D, 0x5D, 0x8F, 0xAA, 0xCE, 0x94,
// };
// 
// // nonceC
// uint8_t nonceC[]  =
// {
// 	0xB9, 0x73, 0x05, 0xFA, 0xDB, 0xE3, 0x4D, 0xC5, 0x46, 0x65,
// 	0x10, 0x00, 0x0A, 0x55, 0x04, 0x2E, 0x3F, 0xEA, 0xBF, 0x27,
// };

TPM_Command *loadCommand(tpm_command commandName)
{
// 	TPM_Command *pCommand = NULL;
// 
// 	switch(commandName){
// 		
// 		
// 		case	TPM_CMD_STARTUP_CLEAR:
// // 				pCommand->commandBytes	= cmd_strct.startupClear.commandBytes;
// // 				pCommand->commandSize	= 12;
// // 				pCommand->numAuths		= cmd_strct.startupClear.numAuths;
// // 				pCommand->numInHandles	= cmd_strct.startupClear.numInHandles;
// // 				pCommand->numOutHandles	= cmd_strct.startupClear.numOutHandles;
// 				//pCommand->= cmd_strct.startupClear.numOutHandles	
// 				asm("nop");					
// 		break;
// 				
// 		/* intentional fall through 'til implemented */		
// 		case	TPM_CMD_CONT_SELFTEST:
// 		case	TPM_CMD_CREATE_EKPAIR:
// 		case	TPM_CMD_TAKE_OWNERSHIP:
// 		case	TPM_CMD_OIAP:
// 		case	TPM_CMD_OSAP:
// 		case	TPM_CMD_OSAP_ET_KH_SRK:
// 		case	TPM_CMD_CREATE_WRAPKEY:
// 		case	TPM_CMD_LOADKEY:
// 		case	TPM_CMD_READKEY:
// 		case	TPM_CMD_SEAL:
// 		case	TPM_CMD_UNSEAL:
// 		case	TPM_CMD_SIGN:
// 		case	TPM_CMD_VERIFY_SIGN:
// 		case	TPM_CMD_GET_PUB_KEY:
// 		case	TPM_CMD_BINDV20_G:
// 		case	TPM_CMD_GET_CAP_VERSVAL:
// 		case	TPM_CMD_RESET:
// 		case	TPM_CMD_FLUSHKEY:
// 		case	TPM_CMD_FORCE_CLEAR:
// 		case	TPM_CMD_PHYS_SET_DEACT_FALSE:
// 		case	TPM_CMD_PHYS_DISABLE:
// 		case	TPM_CMD_PHYS_ENABLE:
// 		case	TPM_GETCAP_VERSION:
// 		case	TPM_CMD_PHYSPRES_PRESENT:
// 		case	TPM_CMD_PHYSSET_DEACT_TRUE:
// 		case	TPM_CMD_GET_VERSION:
// 		case	TPM_CMD_CREATE_WRAPKEY_PCR:
// 		case	TPM_CMD_TERMINATE_HANDLE1:
// 		case	TPM_CMD_TERMINATE_HANDLE0:
// 		case	TPM_CMD_GET_SET_MEM:
// 				break;
// 		
// 	}
// 
// 	if(pCommand != NULL)
// 		return pCommand;
// 	
// 	asm("nop");
	
	/* not found... */
	return (TPM_Command *) NULL;
}

	
#define tableEnt(entryName, numAuth, inHandles, outHandles) \
{_##entryName, __##entryName, sizeof(__##entryName), numAuth, inHandles, outHandles },	
	 
/*
 *	The global table of commands (and meta-commands)
 */
TPM_Command commandTable[] =
{

	//commandName, 				numAuths,	numInHandles,	numOutHandles
	tableEnt(startupClear,		AUTH0,		HAND0,			HAND0)
// 	tableEnt(startupState,		AUTH0,		HAND0,			HAND0)
// 	tableEnt(contSelfTest,		AUTH0,		HAND0,			HAND0)
// 	tableEnt(forceClear,		AUTH0,		HAND0,			HAND0)
// 	tableEnt(OIAP,				AUTH0,		HAND0,			HAND0)
// 	tableEnt(OSAP_ET_KH_SRK,	AUTH0,		HAND0,			HAND0)
// 	tableEnt(OSAP_ET_Key_SRK,	AUTH0,		HAND0,			HAND0)
// 	tableEnt(OSAP,				AUTH0,		HAND0,			HAND0)
// 	tableEnt(createEKPair,		AUTH0,		HAND0,			HAND0)
// 	tableEnt(readEK,			AUTH0,		HAND0,			HAND0)
// 	tableEnt(createWrapKey,		AUTH1,		HAND1,			HAND0)
// 	tableEnt(createWrapKey_PCR,	AUTH1,		HAND1,			HAND0)
// 	tableEnt(loadKey,			AUTH1,		HAND1,			HAND1)
// 	tableEnt(flushKey,			AUTH0,		HAND0,			HAND0)
// 	tableEnt(takeOwnership,		AUTH1,		HAND0,			HAND0)
// 	tableEnt(getPubKey,			AUTH1,		HAND1,			HAND0)
// 	tableEnt(bindV20,			AUTH0,		HAND0,			HAND0)
// 	tableEnt(seal,				AUTH1,		HAND1,			HAND0)
// 	tableEnt(unSeal,			AUTH2,		HAND1,			HAND0)
// 	tableEnt(sign,				AUTH1,		HAND1,			HAND0)
// 	tableEnt(verifySign,		AUTH0,		HAND0,			HAND0)
// 	tableEnt(physPres_present,	AUTH0,		HAND0,			HAND0)
// 	tableEnt(physEnable,		AUTH0,		HAND0,			HAND0)
// 	tableEnt(physDisable,		AUTH0,		HAND0,			HAND0)
// 	tableEnt(physSetDeact_false,AUTH0,		HAND0,			HAND0)
// 	tableEnt(physSetDeact_true,	AUTH0,		HAND0,			HAND0)
// 	tableEnt(reset,				AUTH0,		HAND0,			HAND0)
// 	tableEnt(getSetMem,			AUTH0,		HAND0,			HAND0)
// 	tableEnt(getCap_versVal,	AUTH0,		HAND0,			HAND0)
// 	tableEnt(getCap_version,	AUTH0,		HAND0,			HAND0)
// 	tableEnt(terminateHandle0,	AUTH0,		HAND0,			HAND0)
// 	tableEnt(terminateHandle1,	AUTH0,		HAND0,			HAND0)

//{ 	_bindV20_g, __bindV20, sizeof(__bindV20), genericFunc, AUTH0, HAND0, HAND0 },	// generic version for demo

};

 #define tableEntFuncPtr(entryName, funcName){_##entryName, funcName},


TPM_FuncPtr FuncPtrTable[] =
{

	//commandName, 				commandFunc
	//tableEnt(startupClear,	funcName)
	
//	tableEntFuncPtr(startupClear,		genericFunc)	
// 	tableEntFuncPtr(startupState,		OIAPFunc)
// 	tableEntFuncPtr(contSelfTest,		genericFunc)
// 	tableEntFuncPtr(forceClear,			forceClearFunc)
// 	tableEntFuncPtr(OIAP,				OIAPFunc)
// 	tableEntFuncPtr(OSAP_ET_KH_SRK,		genericFunc)
// 	tableEntFuncPtr(OSAP_ET_Key_SRK,	genericFunc)
// 	tableEntFuncPtr(OSAP,				OSAPHandler)
// 	tableEntFuncPtr(createEKPair,		genericFunc)
// 	tableEntFuncPtr(readEK,				genericFunc)
// 	tableEntFuncPtr(createWrapKey,		createWrapFunc)
// 	tableEntFuncPtr(createWrapKey_PCR,	createWrapFunc)
// 	tableEntFuncPtr(loadKey,			loadKeyFunc)
// 	tableEntFuncPtr(flushKey,			flushKeyFunc)
// 	tableEntFuncPtr(takeOwnership,		takeOwnFunc)
// 	tableEntFuncPtr(getPubKey,			getPubKeyFunc)
// 	tableEntFuncPtr(bindV20,			_bindV20Func)
// 	tableEntFuncPtr(seal,				sealFunc)
// 	tableEntFuncPtr(unSeal,				unSealFunc)
// 	tableEntFuncPtr(sign,				signFunc)
// 	tableEntFuncPtr(verifySign,			verifySignFunc)
// 	tableEntFuncPtr(physPres_present,	genericFunc)
// 	tableEntFuncPtr(physEnable,			genericFunc)
// 	tableEntFuncPtr(physDisable,		disableFunc)
// 	tableEntFuncPtr(physSetDeact_false,	activeFunc)
// 	tableEntFuncPtr(physSetDeact_true,	genericFunc)
// 	tableEntFuncPtr(reset,				genericFunc)
// 	tableEntFuncPtr(getSetMem,			genericFunc)
// 	tableEntFuncPtr(getCap_versVal,		genericFunc)
// 	tableEntFuncPtr(getCap_version,		genericFunc)
// 	tableEntFuncPtr(terminateHandle0,	genericFunc)
// 	tableEntFuncPtr(terminateHandle1,	genericFunc)

	//{ 	_bindV20_g, __bindV20, sizeof(__bindV20), genericFunc, AUTH0, HAND0, HAND0 },	// generic version for demo

};










// global var exposing number of commands
uint16_t numCommands = NUMCOMMANDS;

// global var exposing size of command table
uint16_t commandTableSize = CMDTABLESIZE;


// flash command template data

// struct {
// 	struct{
// 		uint8_t commandBytes[12];
// 		funcPtr	  fcn;
// 		authNum   numAuths;
// 		handleNum numInHandles;
// 		handleNum numOutHandles;
// 	}startupClear;
//
// 	struct{
// 		uint8_t commandBytes[15];
// 		funcPtr	  fcn;
// 		authNum   numAuths;
// 		handleNum numInHandles;
// 		handleNum numOutHandles;
// 	}getSetMem;
//
// 	struct{
// 		uint8_t commandBytes[22];
// 		funcPtr	  fcn;
// 		authNum   numAuths;
// 		handleNum numInHandles;
// 		handleNum numOutHandles;
// 	}getCap_versVal;
//
// 	struct{
// 		uint8_t commandBytes[18];
// 		funcPtr	  fcn;
// 		authNum   numAuths;
// 		handleNum numInHandles;
// 		handleNum numOutHandles;
// 	}getCap_version;
//
// } cmd_strct = {
//
// 	{{/* __startupClear */
// 		0x01, 0xC1,
// 		0x00, 0x00, 0x00, 0x0C,
// 		0x00, 0x00, 0x00, 0x99,
// 		0x00, 0x01
// 	},genericFunc,AUTH0, HAND0, HAND0},
//
// 	{{ /*__getSetMem */
// 		0x00, 0xC1,
// 		0x00, 0x00, 0x00, 0x0F,
// 		0x20, 0x00, 0x00, 0x09,
// 		0x80, 0x01,
// 		0x00, 0x4F,
// 		0x03
// 	},genericFunc,AUTH0, HAND0, HAND0},
//
// 	{{ /*__getCap_versVal */
// 		0x00, 0xC1,
// 		0x00, 0x00, 0x00, 0x16,
// 		0x00, 0x00, 0x00, 0x65,
// 		0x00, 0x00, 0x00, 0x1A,
// 		0x00, 0x00, 0x00, 0x04,
// 		0x00, 0x00, 0x00, 0x00
// 	},genericFunc,AUTH0, HAND0, HAND0},
//
// 	{{ /* __getCap_version */
// 		0x00, 0xc1,
// 		0x00, 0x00, 0x00, 0x12,
// 		0x00, 0x00, 0x00, 0x65,
// 		0x00, 0x00, 0x00, 0x06,
// 		0x00, 0x00, 0x00, 0x00
// 	},genericFunc,AUTH0, HAND0, HAND0}
//
//
// };

